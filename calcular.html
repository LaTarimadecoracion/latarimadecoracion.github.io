<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Google Tag Manager -->
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WN384RL2');
    </script>
    <!-- End Google Tag Manager -->
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WN384RL2"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcular alto ideal | LA TARIMA</title>
    <link rel="stylesheet" href="estilos.css?v=20250918-2">
        <link rel="icon" href="img/ico.png" type="image/png">
    <style>
    /* Resaltado de fila recomendada */
    .fila-recomendada { background: #e8f7ee !important; position: relative; }
    .fila-recomendada::after { content:"★"; color:#1a7f37; font-size:12px; position:absolute; left:4px; top:4px; }
    .fila-seleccionada { outline:2px solid #2563eb; outline-offset:-2px; }
    .fila-seleccionada.fila-recomendada { box-shadow:0 0 0 2px #2563eb inset; }
    </style>
</head>
<body class="barandas">
    <div class="container">
        <!-- CABECERA (INICIO) — LA TARIMA / Carpintería Online -->
        <a href="index.html" style="text-decoration:none; color:inherit;">
            <h1 style="cursor:pointer;">LA TARIMA</h1>
        </a>
        <a href="index.html" style="text-decoration:none; color:inherit;">
            <div class="subtitle" style="cursor:pointer;">Carpintería Online</div>
        </a>
        <!-- BLOQUE DE REDES (INICIO) — botones grises de redes -->
        <div class="socials">
            <!-- TikTok -->
            <a href="https://www.tiktok.com/@latarimadecoracion" target="_blank" rel="noopener" aria-label="TikTok">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M16 3c.3 2 1.7 3.6 3.6 3.9.3 0 .4.2.4.4v2.2c0 .3-.2.5-.5.5-1.7 0-3.3-.6-4.5-1.6v6.6c0 3-2.4 5.5-5.4 5.7-3.2.2-5.9-2.4-5.9-5.6 0-3.1 2.5-5.6 5.6-5.6.4 0 .8 0 1.1.1.2 0 .3.2.3.4v2.3c0 .2-.2.4-.4.4-.3-.1-.6-.1-.9-.1-1.6 0-2.9 1.4-2.8 3 .1 1.5 1.4 2.7 3 2.7 1.6 0 2.9-1.3 2.9-2.9V3.5c0-.3.2-.5.5-.5H16z"/>
                </svg>
            </a>
            <!-- Instagram -->
            <a href="https://www.instagram.com/latarimadecoracion" target="_blank" rel="noopener" aria-label="Instagram">
                <svg viewBox="0 0 24 24" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4"></circle>
                    <circle cx="17" cy="7" r="1.5"></circle>
                </svg>
            </a>
            <!-- Facebook -->
            <a href="https://www.facebook.com/latarimadecoracion" target="_blank" rel="noopener" aria-label="Facebook">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M13 22v-9h3l.5-3H13V8.5c0-.9.3-1.5 1.7-1.5H16V4.3c-.3 0-1.2-.1-2.2-.1-2.2 0-3.8 1.3-3.8 3.9V10H7v3h3v9h3z"/>
                </svg>
            </a>
            <!-- YouTube -->
            <a href="https://www.youtube.com/@latarimadecoracion" target="_blank" rel="noopener" aria-label="YouTube">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M23.5 7.2c-.3-1.2-1.2-2.1-2.4-2.4C19 4.3 12 4.3 12 4.3s-7 0-9.1.5C1.7 5.1.8 6 .5 7.2.1 9.3.1 12 .1 12s0 2.7.4 4.8c.3 1.2 1.2 2.1 2.4 2.4C5 19.7 12 19.7 12 19.7s7 0 9.1-.5c1.2-.3 2.1-1.2 2.4-2.4.4-2.1.4-4.8.4-4.8s0-2.7-.4-4.8zM9.8 15.5V8.5l6 3.5-6 3.5z"/>
                </svg>
            </a>
            <!-- WhatsApp -->
            <a href="https://wa.me/5491167007723" target="_blank" rel="noopener" aria-label="WhatsApp">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.488"/>
                </svg>
            </a>
        </div>
        <!-- BLOQUE DE REDES (FIN) -->
        <div class="product-stack">
            <div class="product-card">
                <div class="product-card-title">Calculadora de barandas</div>
        <!-- Panel de ingreso de medidas -->
        <div id="panelMedidas" style="margin-top:8px;padding:14px 16px;border:1px solid #dcdfe3;background:#fff;border-radius:12px;">
            <h2 style="margin:0 0 8px;font-size:1.05rem;">Ingresá tus medidas</h2>
            <p style="margin:0 0 10px;font-size:0.8rem;line-height:1.3;color:#555;">
                Necesitamos 2 datos para calcular la baranda ideal:<br>
                <strong>B</strong>: Altura del tirante/base desde el piso. (Si el colchón se apoya sobre listones, medí hasta la cara superior del tirante).<br>
                <strong>C</strong>: Altura desde el piso hasta la parte más alta del colchón ya apoyado.<br>
                Todo en <strong>centímetros</strong> (podés usar decimales).
            </p>
            <div style="display:flex;flex-wrap:wrap;gap:16px;align-items:flex-end;">
                <label style="font-size:0.75rem;display:flex;flex-direction:column;gap:4px;">
                    B (tirante/base)
                    <input id="medidaB" type="number" min="0" step="0.1" inputmode="decimal" placeholder="Ej: 10" aria-label="Medida B (tirante/base) en centímetros" style="width:140px;padding:6px 8px;border:1px solid #bbb;border-radius:6px;font-size:14px;" />
                </label>
                <label style="font-size:0.75rem;display:flex;flex-direction:column;gap:4px;">
                    C (hasta arriba colchón)
                    <input id="medidaC" type="number" min="0" step="0.1" inputmode="decimal" placeholder="Ej: 20" aria-label="Medida C (hasta parte superior del colchón) en centímetros" style="width:160px;padding:6px 8px;border:1px solid #bbb;border-radius:6px;font-size:14px;" />
                </label>
                <div style="padding-top:4px;">
                    <button id="btnCalcular" class="btn-action" style="background:#1a7f37;color:#fff;border:none;padding:10px 18px;font-size:0.9rem;letter-spacing:.5px;border-radius:8px;cursor:pointer;">Calcular</button>
                </div>
            </div>
            <div style="margin-top:8px;font-size:0.7rem;color:#666;line-height:1.25;">
                Regla clave: buscamos una <strong>protección útil</strong> (lo que sobresale sobre el colchón) dentro del rango objetivo de cada modelo. Si B &lt; 8 cm reducimos el agarre y esa diferencia pasa a la abertura. Si B &gt; 8 cm la abertura efectiva se achica.
            </div>
        </div>
                <!-- Tabla adicional dinámica: baranda ideal -->
                <table id="tablaBaranda" class="product-table" style="margin-top:14px;">
                    <thead>
                        <tr>
                            <th colspan="3" style="text-align:center;">Determinaremos su baranda ideal</th>
                        </tr>
                        <tr>
                            <th style="width:40%">Modelo</th>
                            <th style="width:30%">Protección útil</th>
                            <th style="width:30%">Alto recomendado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Filas insertadas por script -->
                    </tbody>
                </table>
                <!-- Resumen rápido movido aquí para quedar inmediatamente debajo de la tabla de selección -->
                <div id="resumenRapido" style="display:none;margin-top:12px;padding:12px 14px;border:1px solid #dcdfe3;background:#fafafa;border-radius:10px;font-size:0.9rem;line-height:1.4;">
                    <strong style="display:block;margin-bottom:4px;">Resumen rápido</strong>
                    <div id="resumenContenido"></div>
                    <div id="desgloseIntermedio" style="margin-top:8px;padding-top:8px;border-top:1px dashed #ccc;font-size:0.78rem;color:#333;display:none;"></div>
                    <div style="margin-top:10px;text-align:right;">
                        <button id="btnCopiarResumen" style="background:#1a7f37;color:#fff;border:none;padding:6px 12px;font-size:12px;border-radius:6px;cursor:pointer;">Copiar resumen</button>
                        <span id="copyOk" style="display:none;margin-left:8px;font-size:11px;color:#1a7f37;">Copiado ✔</span>
                    </div>
                </div>
                <!-- Resumen de selección manual -->
                <div id="resumenManual" style="display:none;margin-top:10px;padding:12px 14px;border:1px solid #c9d2da;background:#fff;border-radius:10px;font-size:0.85rem;line-height:1.4;position:relative;">
                    <strong style="display:block;margin-bottom:4px;">Tu elección</strong>
                    <div id="resumenManualContenido"></div>
                    <div id="resumenManualDesglose" style="margin-top:8px;padding-top:6px;border-top:1px dashed #ccc;font-size:0.72rem;color:#333;display:none;"></div>
                    <button id="btnCerrarManual" title="Quitar selección" style="position:absolute;top:6px;right:6px;background:#eee;border:1px solid #ccc;border-radius:4px;font-size:10px;line-height:1;padding:3px 6px;cursor:pointer;">X</button>
                </div>
                <!-- Detalle técnico (cálculos previos) -->
                <div id="resultadoCalculo" style="margin-top:14px;font-size:0.9rem;line-height:1.35;background:#f8f9fb;border:1px solid #e2e5e9;padding:12px 14px;border-radius:10px;display:none;"></div>
            </div>
        </div>

        <!-- CTA fusionado: [INICIO | CONSULTAR] -->
    <nav class="split-btn" aria-label="Acciones de navegación y contacto">
            <a href="index.html" title="Volver al inicio">INICIO</a>
            <a href="https://wa.me/5491167007723" class="consultar" target="_blank" rel="noopener" title="Consultar por WhatsApp">CONSULTAR</a>
        </nav>
        </div>
<script>
(function(){
    const inputB = document.getElementById('medidaB');
    const inputC = document.getElementById('medidaC');
    const btn = document.getElementById('btnCalcular');
    const out = document.getElementById('resultadoCalculo');
    const tablaBarandaBody = document.querySelector('#tablaBaranda tbody');
    const resumenManualBox = document.getElementById('resumenManual');
    const resumenManualContenido = document.getElementById('resumenManualContenido');
    const resumenManualDesglose = document.getElementById('resumenManualDesglose');
    const STORAGE_USER_SEL = 'userSelectedModeloV1';
    function saveUserSelection(nombre){ localStorage.setItem(STORAGE_USER_SEL, nombre || ''); }
    function loadUserSelection(){ try{ return localStorage.getItem(STORAGE_USER_SEL) || ''; }catch(e){ return ''; } }

    function ejecutar(){
        const B = parseFloat(inputB.value);
        const C = parseFloat(inputC.value);
        if(isNaN(B) || isNaN(C)){
            out.style.display='block';
            out.innerHTML = '<span style="color:#c00;">Ingresá valores numéricos en B y C para calcular.</span>';
            tablaBarandaBody.innerHTML='';
            document.getElementById('resumenRapido').style.display='none';
            return;
        }
        // Ocultamos bloque técnico legacy (ya no se usa)
        out.style.display='none';

        // Validación adicional: colchón no puede ser más bajo que el tirante (C >= B aceptable),
        // pero si C < B se advierte (medición inconsistente) y se detiene.
        if(C < B){
            tablaBarandaBody.innerHTML='';
            document.getElementById('resumenRapido').style.display='none';
            resumenManualBox.style.display='none';
            out.style.display='block';
            out.innerHTML = '<span style="color:#c00;">C no puede ser menor que B. Revisá las medidas.</span>';
            return;
        }

        // ================= CONFIG DINÁMICA MODELOS =================
        // Modelos fijos (inmutables)
        const modelosConfig = [
            { nombre:'Clásica 45', nominal:45, agarre:8, soporte:20, minAbertura:5, targetProt:20, rangeProt:[18,22] },
            { nombre:'Clásica 60', nominal:60, agarre:8, soporte:20, minAbertura:5, targetProt:35, rangeProt:[33,37] },
            { nombre:'Montessori 45', nominal:45, agarre:8, soporte:20, minAbertura:5, targetProt:15, rangeProt:[13,17] },
            { nombre:'Simple 35', nominal:35, agarre:8, soporte:20, minAbertura:5, targetProt:10, rangeProt:[10,12], minProteccion:10 }
        ];
        const STORAGE_KEYS = { medidas:'lastMedidasBC' };
        function loadMedidas(){ try{ const s=localStorage.getItem(STORAGE_KEYS.medidas); return s? JSON.parse(s): {}; }catch(e){ return {}; } }
        function saveMedidas(B,C){ localStorage.setItem(STORAGE_KEYS.medidas, JSON.stringify({B,C})); }

        function ajustarAgarre(baseAgarre,B){ return B < baseAgarre ? B : baseAgarre; }
        function calcModeloAvanzado(m){
            const agarreReal = ajustarAgarre(m.agarre,B);
            const estructuraMin = agarreReal + m.soporte + m.minAbertura;
            const proteccionNominal = m.nominal - C;
            let alturaIdeal = C + m.targetProt; if(alturaIdeal < estructuraMin) alturaIdeal = estructuraMin;
            const diff = Math.abs(proteccionNominal - m.targetProt);
            // margen ± eliminado: siempre prioriza target dentro de estructura mínima
            let alturaSugerida = alturaIdeal;
            let abertura = alturaSugerida - (agarreReal + m.soporte);
            if(abertura < m.minAbertura){ alturaSugerida = estructuraMin; abertura = m.minAbertura; usarNominal=false; }
            let proteccion = alturaSugerida - C;
            // Forzar mínimo para modelos con minProteccion (Simple)
            if(m.minProteccion && proteccion < m.minProteccion){
                alturaSugerida = C + m.minProteccion;
                abertura = alturaSugerida - (agarreReal + m.soporte);
                proteccion = alturaSugerida - C;
            }
            const [pMin,pMax] = m.rangeProt;
            let estado = proteccion < pMin ? 'Baja' : (proteccion > pMax ? 'Alta' : 'Óptima');
            const color = estado==='Óptima' ? '#1a7f37' : (estado==='Baja' ? '#d97706' : '#b91c1c');
            let nota;
            if(m.minProteccion && proteccion < m.minProteccion) nota = `Elevada para mínimo ${m.minProteccion} cm`;
            else if(Math.abs(alturaSugerida - m.nominal) > 0.5) nota = `Ajustada desde ${m.nominal} cm`;
            else nota = 'Sin ajuste';
            // Abertura fórmula usuario: (H - proteccion - (C - (B - (agarreStd)))) => se simplifica a B - agarreStd (si proteccion = H - C)
            let aberturaFormula = B - m.agarre; if(aberturaFormula < 0) aberturaFormula = 0;
            return { ...m, agarreReal, abertura:+abertura.toFixed(1), aberturaFormula:+aberturaFormula.toFixed(1), alturaSugerida:+alturaSugerida.toFixed(1), proteccion:+proteccion.toFixed(1), estado, color, nota, rango:`${pMin}–${pMax}`, proteccionNominal:+proteccionNominal.toFixed(1), diffTarget:+diff.toFixed(1) };
        }
        const evalAvanzado = modelosConfig.map(calcModeloAvanzado);
    window._lastEvalAvanzado = evalAvanzado; // guardar para selección manual
        let cand = evalAvanzado.filter(x=>x.estado==='Óptima'); if(!cand.length) cand = evalAvanzado.slice();
        const recomendadoAv = cand.sort((a,b)=>Math.abs(a.proteccion-a.targetProt)-Math.abs(b.proteccion-b.targetProt))[0];
        const filasAv = evalAvanzado.map(e=>`<tr data-modelo="${e.nombre}"><td>${e.nombre}<div style=\"font-size:10px;color:#666;\">Rango ${e.rango} (target ${e.targetProt})</div></td><td style=\"text-align:right;\">${e.proteccion} cm <span style=\"font-size:11px;color:${e.color};\">(${e.estado})</span><div style=\"font-size:10px;color:#777;\">Abertura: ${e.abertura} cm</div></td><td style=\"text-align:right;\">${e.alturaSugerida} cm<div style=\"font-size:10px;color:#777;\">${e.nota}</div></td></tr>`).join('');
        tablaBarandaBody.innerHTML = filasAv;
        const resumen = document.getElementById('resumenRapido');
        const cont = document.getElementById('resumenContenido');
    cont.innerHTML = `Modelo recomendado: <strong>${recomendadoAv.nombre}</strong><br>Protección útil: <strong>${recomendadoAv.proteccion} cm</strong> (rango ${recomendadoAv.rango}, target ${recomendadoAv.targetProt})<br>Altura sugerida: <strong>${recomendadoAv.alturaSugerida} cm</strong> (${recomendadoAv.nota})<br>Abertura resultante: <strong>${recomendadoAv.abertura} cm</strong><br>Protección nominal: <strong>${recomendadoAv.proteccionNominal} cm</strong> (Δ target: ${recomendadoAv.diffTarget} cm)<br>Estado: <span style=\"color:${recomendadoAv.color};\">${recomendadoAv.estado}</span>`;
        resumen.style.display='block';
        const desglose = document.getElementById('desgloseIntermedio');
    desglose.innerHTML = `Agarre real: <strong>${recomendadoAv.agarreReal} cm</strong> | Soporte: <strong>${recomendadoAv.soporte} cm</strong> | Abertura estructural: <strong>${recomendadoAv.abertura} cm</strong> | Abertura fórmula: <strong>${recomendadoAv.aberturaFormula} cm</strong> | Protección útil: <strong>${recomendadoAv.proteccion} cm</strong>`;
        desglose.style.display='block';
        Array.from(tablaBarandaBody.querySelectorAll('tr')).forEach(tr=>{ 
            const nombre = tr.getAttribute('data-modelo');
            if(nombre===recomendadoAv.nombre) tr.classList.add('fila-recomendada');
            tr.style.cursor='pointer';
        });

        // Si había una selección manual previa la re-renderizamos
        const storedSel = loadUserSelection();
        if(storedSel){
            const encontrado = evalAvanzado.find(m=>m.nombre===storedSel);
            if(encontrado){ renderSeleccionManual(encontrado, recomendadoAv); }
            else { saveUserSelection(''); resumenManualBox.style.display='none'; }
        } else {
            resumenManualBox.style.display = 'none';
        }

        attachRowSelection(recomendadoAv);
    }

    function attachRowSelection(recomendado){
        tablaBarandaBody.addEventListener('click', function(e){
            const tr = e.target.closest('tr'); if(!tr) return;
            const nombre = tr.getAttribute('data-modelo'); if(!nombre) return;
            const evals = window._lastEvalAvanzado || [];
            const modelo = evals.find(m=>m.nombre===nombre); if(!modelo) return;
            renderSeleccionManual(modelo, recomendado);
            saveUserSelection(nombre);
        }, { once:true }); // se vuelve a registrar tras cada recalculo
    }

    function renderSeleccionManual(modelo, recomendado){
        if(!modelo){ resumenManualBox.style.display='none'; return; }
        const esRecomendado = recomendado && modelo.nombre===recomendado.nombre;
        const advertencias = [];
        if(!esRecomendado){
            if(modelo.estado==='Baja') advertencias.push('Protección por debajo del rango recomendado.');
            else if(modelo.estado==='Alta') advertencias.push('Protección más alta de lo necesario.');
            else {
                // Óptima pero no la más cercana al target
                const diffSel = Math.abs(modelo.proteccion - modelo.targetProt);
                const diffRec = Math.abs(recomendado.proteccion - recomendado.targetProt);
                if(diffSel > diffRec + 0.1) advertencias.push('Hay otra opción más cercana al objetivo.');
            }
        }
    resumenManualContenido.innerHTML = `Modelo: <strong>${modelo.nombre}</strong>${esRecomendado? ' <span style="color:#1a7f37;">(También recomendado)</span>':''}<br>
    Protección útil: <strong>${modelo.proteccion} cm</strong> (target ${modelo.targetProt}, Δ ${modelo.diffTarget} cm)<br>
    Estado de protección: <span style="color:${modelo.color};font-weight:600;">${modelo.estado}</span><br>
    Altura sugerida: <strong>${modelo.alturaSugerida} cm</strong> (${modelo.nota})<br>
    Abertura estructural: <strong>${modelo.abertura} cm</strong>`;
        resumenManualDesglose.innerHTML = `Agarre real: <strong>${modelo.agarreReal} cm</strong> | Soporte: <strong>${modelo.soporte} cm</strong> | Abertura estructural: <strong>${modelo.abertura} cm</strong> | Abertura fórmula: <strong>${modelo.aberturaFormula} cm</strong> | Protección nominal: <strong>${modelo.proteccionNominal} cm</strong>`;
        resumenManualDesglose.style.display='block';
        if(advertencias.length){
            resumenManualContenido.innerHTML += `<div style="margin-top:6px;color:#b45309;font-size:0.7rem;">${advertencias.map(a=>`• ${a}`).join('<br>')}</div>`;
        }
        resumenManualBox.style.display='block';
        marcarFilaSeleccionada(modelo.nombre, recomendado?.nombre);
    }

    function marcarFilaSeleccionada(nombreSel, nombreRec){
        tablaBarandaBody.querySelectorAll('tr').forEach(tr=>{
            tr.classList.remove('fila-seleccionada');
            const n = tr.getAttribute('data-modelo');
            if(n===nombreSel && n!==nombreRec){ tr.classList.add('fila-seleccionada'); }
        });
    }

    const cerrarManualBtn = document.getElementById('btnCerrarManual');
    if(cerrarManualBtn){
        cerrarManualBtn.addEventListener('click', ()=>{
            saveUserSelection('');
            resumenManualBox.style.display='none';
            marcarFilaSeleccionada('', window._lastEvalAvanzado?.find(m=>m).nombre);
        });
    }

    btn.addEventListener('click', (e)=>{e.preventDefault(); ejecutar();});
    // Auto-cálculo al cambiar B o C
    ['input','change'].forEach(evt=>{
        inputB.addEventListener(evt, ()=>{ if(inputB.value!=='' && inputC.value!==''){ saveMedidas(parseFloat(inputB.value), parseFloat(inputC.value)); ejecutar(); } });
        inputC.addEventListener(evt, ()=>{ if(inputB.value!=='' && inputC.value!==''){ saveMedidas(parseFloat(inputB.value), parseFloat(inputC.value)); ejecutar(); } });
    });
    // Si ya hay valores precargados (autocompletado navegador) calcular
    window.addEventListener('DOMContentLoaded', ()=>{
    const last=loadMedidas(); if(last.B!=null) inputB.value=last.B; if(last.C!=null) inputC.value=last.C; if(inputB.value!=='' && inputC.value!==''){ ejecutar(); }
        const btnCopiar = document.getElementById('btnCopiarResumen');
        const copyOk = document.getElementById('copyOk');
        if(btnCopiar){
            btnCopiar.addEventListener('click', ()=>{
                const texto = document.getElementById('resumenContenido').innerText + '\n' + document.getElementById('desgloseIntermedio').innerText;
                if(navigator.clipboard){
                    navigator.clipboard.writeText(texto).then(()=>{
                        copyOk.style.display='inline';
                        setTimeout(()=>copyOk.style.display='none',1800);
                    });
                } else {
                    // fallback
                    const ta = document.createElement('textarea');
                    ta.value = texto; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
                    copyOk.style.display='inline';
                    setTimeout(()=>copyOk.style.display='none',1800);
                }
            });
        }
    });
})();
</script>
</body>
<script src="responsive-tables.js?v=20250918-2"></script>
</html>
