<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor de P√°gina de Inicio | LA TARIMA</title>
    <link rel="stylesheet" href="estilos.css">
    <link rel="stylesheet" href="Links/editor.css">
    <link rel="icon" href="img/ico.png" type="image/png">
    <style>
        body {
            background: #f8f9fa;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .section-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
        }
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }
        .config-group {
            margin-bottom: 15px;
        }
        .config-label {
            display: block;
            font-weight: 500;
            margin-bottom: 5px;
            color: #555;
        }
        .config-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .config-textarea {
            min-height: 80px;
            resize: vertical;
        }
        .items-container {
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
        }
        .item-row {
            display: grid;
            grid-template-columns: 1fr 1fr auto auto;
            gap: 10px;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #f1f3f4;
            margin-bottom: 10px;
        }
        .item-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .item-input {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }
        .toggle-btn {
            padding: 4px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            font-weight: 500;
        }
        .toggle-btn.active {
            background: #27ae60;
            color: white;
        }
        .toggle-btn.inactive {
            background: #e74c3c;
            color: white;
        }
        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .add-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
        }
        .actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 30px 0;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary { background: #3498db; color: white; }
        .btn-success { background: #27ae60; color: white; }
        .btn-warning { background: #f39c12; color: white; }
        .btn-info { background: #17a2b8; color: white; }
        .status-message {
            padding: 12px;
            border-radius: 6px;
            margin: 15px 0;
            font-weight: 500;
        }
        .status-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .dropdown-items {
            margin-left: 20px;
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header style="text-align: center; margin-bottom: 30px;">
            <h1>üè† Editor de P√°gina de Inicio</h1>
            <p>Gestiona el contenido principal de la home de forma visual</p>
        </header>

        <div class="status-message" id="status-message" style="display: none;"></div>

        <!-- Configuraci√≥n General -->
        <div class="section-card">
            <h2 class="section-title">‚öôÔ∏è Configuraci√≥n General</h2>
            <div class="config-group">
                <label class="config-label">T√≠tulo Principal</label>
                <input type="text" class="config-input" id="titulo" placeholder="LA TARIMA">
            </div>
            <div class="config-group">
                <label class="config-label">Subt√≠tulo</label>
                <input type="text" class="config-input" id="subtitulo" placeholder="Carpinter√≠a Online">
            </div>
            <div class="config-group">
                <label class="config-label">Descripci√≥n SEO</label>
                <textarea class="config-input config-textarea" id="descripcion" placeholder="Descripci√≥n para motores de b√∫squeda"></textarea>
            </div>
        </div>

        <!-- Redes Sociales Header -->
        <div class="section-card">
            <h2 class="section-title">üåê Redes Sociales (Header)</h2>
            <div class="items-container" id="redes-container">
                <!-- Se llenan din√°micamente -->
            </div>
            <button class="add-btn" onclick="agregarRed()">+ Agregar Red Social</button>
        </div>

        <!-- Men√∫ Principal -->
        <div class="section-card">
            <h2 class="section-title">üìã Men√∫ Principal</h2>
            <div class="items-container" id="menu-container">
                <!-- Se llenan din√°micamente -->
            </div>
            <button class="add-btn" onclick="agregarMenuItem()">+ Agregar Elemento de Men√∫</button>
        </div>

        <!-- Botones de Redes -->
        <div class="section-card">
            <h2 class="section-title">üîó Botones de Redes</h2>
            <div class="items-container" id="botones-container">
                <!-- Se llenan din√°micamente -->
            </div>
            <button class="add-btn" onclick="agregarBotonRed()">+ Agregar Bot√≥n de Red</button>
        </div>

        <!-- Acciones -->
        <div class="actions">
            <button class="btn btn-primary" onclick="cargarDatos()">
                üîÑ Recargar Datos
            </button>
            <button class="btn btn-success" onclick="guardarDatos()">
                üíæ Guardar Cambios
            </button>
            <button class="btn btn-warning" onclick="previsualizarCambios()">
                üëÅÔ∏è Previsualizar
            </button>
            <a href="index.html" class="btn btn-info">
                üè† Volver al Inicio
            </a>
        </div>
    </div>

    <script>
        let datosHome = {};

        // Cargar datos al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            cargarDatos();
        });

        async function cargarDatos() {
            try {
                const response = await fetch('home-data.json');
                if (response.ok) {
                    datosHome = await response.json();
                    mostrarDatos();
                    mostrarMensaje('‚úÖ Datos cargados correctamente', 'success');
                } else {
                    throw new Error('No se pudo cargar el archivo');
                }
            } catch (error) {
                console.error('Error al cargar datos:', error);
                mostrarMensaje('‚ùå Error al cargar datos: ' + error.message, 'error');
                // Crear estructura vac√≠a si no existe
                datosHome = {
                    configuracion: { titulo: '', subtitulo: '', descripcion: '' },
                    redes_sociales: [],
                    menu_principal: [],
                    redes_botones: []
                };
                mostrarDatos();
            }
        }

        function mostrarDatos() {
            // Configuraci√≥n general
            document.getElementById('titulo').value = datosHome.configuracion?.titulo || '';
            document.getElementById('subtitulo').value = datosHome.configuracion?.subtitulo || '';
            document.getElementById('descripcion').value = datosHome.configuracion?.descripcion || '';

            // Redes sociales
            mostrarRedes();
            mostrarMenu();
            mostrarBotones();
        }

        function mostrarRedes() {
            const container = document.getElementById('redes-container');
            container.innerHTML = '';
            
            (datosHome.redes_sociales || []).forEach((red, index) => {
                const row = document.createElement('div');
                row.className = 'item-row';
                row.innerHTML = `
                    <input type="text" class="item-input" value="${red.nombre}" onchange="actualizarRed(${index}, 'nombre', this.value)" placeholder="Nombre de la red">
                    <input type="url" class="item-input" value="${red.enlace}" onchange="actualizarRed(${index}, 'enlace', this.value)" placeholder="URL del enlace">
                    <button class="toggle-btn ${red.activo ? 'active' : 'inactive'}" onclick="toggleRed(${index})">
                        ${red.activo ? 'Activo' : 'Inactivo'}
                    </button>
                    <button class="delete-btn" onclick="eliminarRed(${index})">üóëÔ∏è</button>
                `;
                container.appendChild(row);
            });
        }

        function mostrarMenu() {
            const container = document.getElementById('menu-container');
            container.innerHTML = '';
            
            (datosHome.menu_principal || []).forEach((item, index) => {
                const row = document.createElement('div');
                row.className = 'item-row';
                
                if (item.tipo === 'dropdown') {
                    row.innerHTML = `
                        <div style="grid-column: 1 / -1;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr auto auto; gap: 10px; align-items: center;">
                                <input type="text" class="item-input" value="${item.titulo}" onchange="actualizarMenuItem(${index}, 'titulo', this.value)" placeholder="T√≠tulo del dropdown">
                                <span style="color: #666; font-size: 12px;">Tipo: Dropdown</span>
                                <button class="toggle-btn ${item.activo ? 'active' : 'inactive'}" onclick="toggleMenuItem(${index})">
                                    ${item.activo ? 'Activo' : 'Inactivo'}
                                </button>
                                <button class="delete-btn" onclick="eliminarMenuItem(${index})">üóëÔ∏è</button>
                            </div>
                            <div class="dropdown-items">
                                ${(item.subitems || []).map((subitem, subindex) => `
                                    <div style="display: grid; grid-template-columns: 1fr 1fr auto auto; gap: 8px; margin: 5px 0; align-items: center;">
                                        <input type="text" class="item-input" value="${subitem.titulo}" onchange="actualizarSubitem(${index}, ${subindex}, 'titulo', this.value)" placeholder="T√≠tulo">
                                        <input type="text" class="item-input" value="${subitem.enlace}" onchange="actualizarSubitem(${index}, ${subindex}, 'enlace', this.value)" placeholder="Enlace">
                                        <button class="toggle-btn ${subitem.activo ? 'active' : 'inactive'}" onclick="toggleSubitem(${index}, ${subindex})">
                                            ${subitem.activo ? 'Activo' : 'Inactivo'}
                                        </button>
                                        <button class="delete-btn" onclick="eliminarSubitem(${index}, ${subindex})">üóëÔ∏è</button>
                                    </div>
                                `).join('')}
                                <button class="add-btn" onclick="agregarSubitem(${index})" style="margin-top: 8px;">+ Agregar Subitem</button>
                            </div>
                        </div>
                    `;
                } else {
                    row.innerHTML = `
                        <input type="text" class="item-input" value="${item.titulo}" onchange="actualizarMenuItem(${index}, 'titulo', this.value)" placeholder="T√≠tulo">
                        <input type="text" class="item-input" value="${item.enlace}" onchange="actualizarMenuItem(${index}, 'enlace', this.value)" placeholder="Enlace">
                        <button class="toggle-btn ${item.activo ? 'active' : 'inactive'}" onclick="toggleMenuItem(${index})">
                            ${item.activo ? 'Activo' : 'Inactivo'}
                        </button>
                        <button class="delete-btn" onclick="eliminarMenuItem(${index})">üóëÔ∏è</button>
                    `;
                }
                container.appendChild(row);
            });
        }

        function mostrarBotones() {
            const container = document.getElementById('botones-container');
            container.innerHTML = '';
            
            (datosHome.redes_botones || []).forEach((boton, index) => {
                const row = document.createElement('div');
                row.className = 'item-row';
                row.innerHTML = `
                    <input type="text" class="item-input" value="${boton.titulo}" onchange="actualizarBoton(${index}, 'titulo', this.value)" placeholder="Texto del bot√≥n">
                    <input type="url" class="item-input" value="${boton.enlace}" onchange="actualizarBoton(${index}, 'enlace', this.value)" placeholder="URL del enlace">
                    <button class="toggle-btn ${boton.activo ? 'active' : 'inactive'}" onclick="toggleBoton(${index})">
                        ${boton.activo ? 'Activo' : 'Inactivo'}
                    </button>
                    <button class="delete-btn" onclick="eliminarBoton(${index})">üóëÔ∏è</button>
                `;
                container.appendChild(row);
            });
        }

        // Funciones de actualizaci√≥n
        function actualizarRed(index, campo, valor) {
            datosHome.redes_sociales[index][campo] = valor;
        }

        function toggleRed(index) {
            datosHome.redes_sociales[index].activo = !datosHome.redes_sociales[index].activo;
            mostrarRedes();
        }

        function eliminarRed(index) {
            datosHome.redes_sociales.splice(index, 1);
            mostrarRedes();
        }

        function agregarRed() {
            datosHome.redes_sociales.push({
                nombre: 'Nueva Red',
                enlace: 'https://',
                activo: true
            });
            mostrarRedes();
        }

        function actualizarMenuItem(index, campo, valor) {
            datosHome.menu_principal[index][campo] = valor;
        }

        function toggleMenuItem(index) {
            datosHome.menu_principal[index].activo = !datosHome.menu_principal[index].activo;
            mostrarMenu();
        }

        function eliminarMenuItem(index) {
            datosHome.menu_principal.splice(index, 1);
            mostrarMenu();
        }

        function agregarMenuItem() {
            const tipo = confirm('¬øCrear un dropdown? (Cancelar para enlace simple)') ? 'dropdown' : 'enlace';
            
            if (tipo === 'dropdown') {
                datosHome.menu_principal.push({
                    tipo: 'dropdown',
                    titulo: 'Nuevo Dropdown',
                    icono: 'arrow',
                    activo: true,
                    subitems: []
                });
            } else {
                datosHome.menu_principal.push({
                    tipo: 'enlace',
                    titulo: 'Nuevo Enlace',
                    enlace: '#',
                    icono: 'flaticon',
                    activo: true
                });
            }
            mostrarMenu();
        }

        function actualizarSubitem(menuIndex, subIndex, campo, valor) {
            datosHome.menu_principal[menuIndex].subitems[subIndex][campo] = valor;
        }

        function toggleSubitem(menuIndex, subIndex) {
            datosHome.menu_principal[menuIndex].subitems[subIndex].activo = !datosHome.menu_principal[menuIndex].subitems[subIndex].activo;
            mostrarMenu();
        }

        function eliminarSubitem(menuIndex, subIndex) {
            datosHome.menu_principal[menuIndex].subitems.splice(subIndex, 1);
            mostrarMenu();
        }

        function agregarSubitem(menuIndex) {
            datosHome.menu_principal[menuIndex].subitems.push({
                titulo: 'Nuevo Subitem',
                enlace: '#',
                activo: true
            });
            mostrarMenu();
        }

        function actualizarBoton(index, campo, valor) {
            datosHome.redes_botones[index][campo] = valor;
        }

        function toggleBoton(index) {
            datosHome.redes_botones[index].activo = !datosHome.redes_botones[index].activo;
            mostrarBotones();
        }

        function eliminarBoton(index) {
            datosHome.redes_botones.splice(index, 1);
            mostrarBotones();
        }

        function agregarBotonRed() {
            datosHome.redes_botones.push({
                nombre: 'Nueva Red',
                titulo: 'Nuevo Bot√≥n',
                enlace: 'https://',
                color: '#3498db',
                activo: true
            });
            mostrarBotones();
        }

        function guardarDatos() {
            // Actualizar configuraci√≥n
            datosHome.configuracion.titulo = document.getElementById('titulo').value;
            datosHome.configuracion.subtitulo = document.getElementById('subtitulo').value;
            datosHome.configuracion.descripcion = document.getElementById('descripcion').value;

            // Crear el JSON para descarga
            const dataStr = JSON.stringify(datosHome, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'home-data.json';
            link.click();
            
            URL.revokeObjectURL(url);
            mostrarMensaje('‚úÖ Archivo descargado. S√∫belo al servidor para aplicar cambios.', 'success');
        }

        function previsualizarCambios() {
            mostrarMensaje('‚ÑπÔ∏è Funci√≥n de previsualizaci√≥n en desarrollo. Guarda y recarga la p√°gina para ver cambios.', 'success');
        }

        function mostrarMensaje(mensaje, tipo) {
            const statusDiv = document.getElementById('status-message');
            statusDiv.textContent = mensaje;
            statusDiv.className = `status-message status-${tipo}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>